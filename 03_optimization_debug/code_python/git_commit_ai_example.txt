fix bug

change some code and improve something.