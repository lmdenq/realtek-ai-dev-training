# Prompt：請協助找出程式效能瓶頸並重構為 O(n)

你是一位熟悉 Python 效能最佳化的資深工程師。  
我有一支程式執行非常慢，應該是 O(n^2) 的邏輯。

【請幫我做到】
1. 找出瓶頸
2. 用中文說明原因
3. 重寫成 O(n) 的演算法（使用 set / dict）
4. 顯示效能預估差異
5. 請給完整程式碼（Python）

【原始程式碼】：
```python
(貼 slow_script_manual.py)
```